import { Meta } from '@storybook/addon-docs/blocks';
import { LIBRARY_NAME } from '../constants';

<Meta title="Guia de Contribui√ß√£o/Conven√ß√µes do Projeto" />

# Conven√ß√µes do Projeto

Este guia apresenta as conven√ß√µes essenciais para desenvolvimento de componentes na {LIBRARY_NAME}, organizadas em ordem de import√¢ncia e aplica√ß√£o pr√°tica.

## 1. Fundamentos: Design System e Figma

**Ponto de partida obrigat√≥rio**: Todos os componentes devem ser desenvolvidos com base nos designs da biblioteca do <a href="https://www.figma.com/design/epCGtlKQxedDxQVlK3lNcN/DSC-%7C-React-Native---Tamagui?node-id=1180-3541&p=f&t=sNYfTUNxw7ZfqylZ-0" target="_blank" rel="noopener noreferrer">Figma do projeto</a>.

**Processo recomendado:**
1. Consulte o Figma antes de iniciar o desenvolvimento
2. Identifique os tokens e cores utilizados no design
3. Respeite as especifica√ß√µes de espa√ßamento, cores e tipografia
4. Valide o resultado final com o design proposto

## 2. Sistema de Tokens: Base da Consist√™ncia Visual

**Regra fundamental**: **Sempre** utilize os [tokens](?path=/docs/design-system-tokens-vis√£o-geral--docs) e [temas](?path=/docs/design-system-temas-vis√£o-geral--docs) definidos na configura√ß√£o do Tamagui para manter a consist√™ncia visual.

**‚úÖ Construindo com tokens:**

```tsx
const MyComponent = styled(View, {
  backgroundColor: '$highlightBg',
  padding: '$small',
  borderRadius: '$nano',
});
```

**‚ùå Utilizando valores fixos:**

```tsx
const MyComponent = styled(View, {
  backgroundColor: '#FFFFFF',
  padding: 16,
  borderRadius: 8,
});
```

### Interpretando Cores do Figma

Quando voc√™ inspeciona um elemento no Figma, ver√° informa√ß√µes como: **`color/success/successBg [Color 2]`**

**Pergunta-chave**: *A cor deve mudar conforme o tema aplicado?*

- **SIM** ‚Üí Use `$color2` (cor adapt√°vel ao tema)
- **N√ÉO** ‚Üí Use `$successBg` (cor sem√¢ntica fixa)

#### Exemplos Pr√°ticos:

**Cores que se adaptam ao tema:**
```tsx
// Verde no tema success, vermelho no tema danger
<Button backgroundColor="$color8" theme="success">Confirmar</Button>
<Button backgroundColor="$color8" theme="danger">Excluir</Button>
```

**Cores sempre fixas:**
```tsx
// Sempre azul, independente do tema
<Button backgroundColor="$infoBg" theme="danger">Informa√ß√µes</Button>
```

> üí° **Dica**: Quando voc√™ n√£o especifica tema, o sistema usa automaticamente a paleta `neutral`

> ‚ö†Ô∏è **Importante**: Consulte a documenta√ß√£o do [Sistema de Temas](?path=/docs/guia-de-contribui√ß√£o-sistema-de-temas--docs) para entender como construir componentes que se adaptam corretamente aos diferentes temas.

## 3. Tipografia: Componentes Espec√≠ficos da Biblioteca

**Regra**: Use sempre os [componentes de tipografia](?path=/docs/components-typography--docs) espec√≠ficos da {LIBRARY_NAME} para manter consist√™ncia visual e sem√¢ntica.

### Componentes Recomendados

**Para textos gerais:**
```tsx
import {
  DisplayStandard,
  TitleLarge,
  BodyStandard,
  LabelSmall
} from '@superapp-caixa/dsc-library';

<DisplayStandard>T√≠tulo Principal da Tela</DisplayStandard>
<TitleLarge>Se√ß√£o Importante</TitleLarge>
<BodyStandard>Texto explicativo do conte√∫do</BodyStandard>
<LabelSmall>R√≥tulo de campo</LabelSmall>
```

**Para valores num√©ricos:**
```tsx
import { DisplayNumericalStandard, TitleNumericalLarge } from '@superapp-caixa/dsc-library';

<DisplayNumericalStandard>R$ 1.234,56</DisplayNumericalStandard>
<TitleNumericalLarge>1.000</TitleNumericalLarge>
```

### Alternativa: Presets Diretos (Uso Espec√≠fico)

Para componentes customizados onde os componentes prontos de tipografia n√£o atendem:

```tsx
import { styled, Text } from 'tamagui';
import { typography } from '@superapp-caixa/dsc-library';

const CustomTitle = styled(Text, {
  ...typography.titleLarge,
  color: '$color9',
});
```

> ‚ö†Ô∏è **Importante**: Sempre prefira os [componentes de tipografia](?path=/docs/components-typography--docs). Use presets diretos apenas quando os componentes prontos n√£o atendem ao caso espec√≠fico.

## 4. Sistema de √çcones: Iconoir + Customizados

A {LIBRARY_NAME} suporta dois tipos de √≠cones: √≠cones da biblioteca <a href="https://iconoir.com/" target="_blank" rel="noopener noreferrer">Iconoir</a> para uso geral e √≠cones customizados espec√≠ficos do projeto.

### Componente Icon (Uso Geral)

**Sempre use o componente `Icon`** para renderizar √≠cones, garantindo consist√™ncia:

**√çcones do Iconoir:**
```tsx
import { Icon } from '@superapp-caixa/dsc-library';
import { Home, Settings } from 'iconoir-react-native';

<Icon size="medium" color="$color9">
  <Home />
</Icon>
```

**√çcones customizados da biblioteca:**
```tsx
import { Icon, Loterias, Pix } from '@superapp-caixa/dsc-library';

<Icon size="large" color="$primary">
  <Loterias />
</Icon>
```

**Em bot√µes e outros componentes:**
```tsx
<Button 
  icon={(props) => (
    <Icon size="small" color={props.color}>
      <Home />
    </Icon>
  )}
>
  In√≠cio
</Button>
```

### Hook useTransformIcon (Desenvolvimento Interno)

Para desenvolvimento de componentes da biblioteca:

```tsx
import { useTransformIcon } from '../../../utils';
import { Heart } from 'iconoir-react-native';

const MyComponent = ({ iconColor = '$color9', iconSize = 24 }) => {
  const transformIcon = useTransformIcon();
  const renderedIcon = transformIcon(Heart, iconSize, iconColor);
  
  return <View>{renderedIcon}</View>;
};
```

> ‚ö†Ô∏è **Importante**: O hook `useTransformIcon` √© para uso interno. Para uso final, sempre prefira o componente `Icon`.

### Adicionando Novos √çcones

Para adicionar novos √≠cones SVG, consulte o [Guia de Adi√ß√£o de √çcones](?path=/docs/guia-de-contribui√ß√£o-adicionando-√≠cones--docs).

## 5. Criando Componentes: Styled e Variants

Crie componentes usando `styled()` do Tamagui e defina **variants** para diferen√ßas visuais.

**Links √∫teis:**
- <a href="https://tamagui.dev/docs/core/styled" target="_blank" rel="noopener noreferrer">Tamagui - Styled</a>  
- <a href="https://tamagui.dev/docs/core/variants" target="_blank" rel="noopener noreferrer">Tamagui - Variants</a>

### Estrutura Padr√£o de Componente

```tsx
import { styled, View } from 'tamagui';

const DscCard = styled(View, {
  name: 'DscCard', // OBRIGAT√ìRIO - facilita debugging

  // Estilos base
  borderRadius: '$nano',
  padding: '$large',
  backgroundColor: '$color1',

  // Estados interativos OBRIGAT√ìRIOS
  hoverStyle: {
    backgroundColor: '$color2',
  },
  pressStyle: {
    backgroundColor: '$color3',
  },
  focusStyle: {
    borderColor: '$color9',
    borderWidth: 2,
    zIndex: 500, // Use 500+ para bordas de foco
  },
  disabledStyle: {
    opacity: 0.5,
    backgroundColor: '$neutral3',
  },

  // Variants para customiza√ß√£o
  variants: {
    theme: {
      neutral: {
        backgroundColor: '$neutral1',
        borderColor: '$neutral4',
      },
      highlight: {
        backgroundColor: '$color2',
        borderColor: '$color6',
      },
      danger: {
        backgroundColor: '$red2',
        borderColor: '$red6',
      },
    },
    size: {
      small: { padding: '$small' },
      large: { padding: '$large' },
    },
  } as const,
});
```

### Checklist de Requisitos Obrigat√≥rios

- ‚úÖ **Prop `name`**: Sempre defina para facilitar debugging
- ‚úÖ **Estados interativos**: `hoverStyle`, `pressStyle`, `focusStyle` quando aplic√°vel
- ‚úÖ **Z-index para foco**: Use valores 500+ para bordas de foco
- ‚úÖ **Tema padr√£o**: Use 'highlight' como tema padr√£o nos componentes

## 6. Definindo Interfaces: Modelos de Tipos (.model)

Utilize arquivos `.model.ts` para definir e limitar as possibilidades de customiza√ß√£o, especialmente quando baseado em componentes existentes do Tamagui.

### Padr√£o de Interface B√°sica

```tsx
// ComponentName.model.ts
import { ViewProps } from 'tamagui';

export interface ComponentNameProps extends ViewProps {
  /** Tema visual do componente */
  theme?: 'highlight' | 'neutral' | 'danger';
  /** Tamanho do componente */
  size?: 'small' | 'standard' | 'large';
  /** Texto principal */
  title: string;
  /** Texto opcional secund√°rio */
  subtitle?: string;
  /** Fun√ß√£o chamada ao pressionar */
  onPress?: () => void;
  /** Estado de carregamento */
  loading?: boolean;
  /** Estado desabilitado */
  disabled?: boolean;
}
```

### Estendendo Componentes do Tamagui

Para componentes baseados em Tamagui, use `Omit` para remover props conflitantes:

```tsx
// Button.model.ts
import { ButtonProps as TamaguiButtonProps } from 'tamagui';

export interface ButtonProps extends Omit<TamaguiButtonProps, 'size' | 'theme'> {
  /** Tema visual do bot√£o */
  theme?: 'highlight' | 'neutral' | 'danger';
  /** Tamanho do bot√£o */
  size?: 'small' | 'standard' | 'large';
  /** Tipo visual do bot√£o */
  type?: 'plain' | 'outline' | 'chromeless';
  /** Estado de carregamento */
  loading?: boolean;
}
```

### Acessibilidade: Props Obrigat√≥rias

Sempre inclua props de acessibilidade nas interfaces:

```tsx
export interface ComponentProps extends ViewProps {
  // props do componente...
  
  /** Label para acessibilidade */
  accessibilityLabel?: string;
  /** Papel do elemento para acessibilidade */
  accessibilityRole?: 'button' | 'header' | 'text' | 'image';
  /** Dica para acessibilidade */
  accessibilityHint?: string;
}
```

## 7. Layout Responsivo: Flexbox como Base

**Regra fundamental**: Utilize flexbox como principal ferramenta de layout. Evite tamanhos fixos (`width`/`height`) sempre que poss√≠vel.

### Componentes de Layout do Tamagui

**YStack para layouts verticais:**
```tsx
<YStack space="$medium" padding="$medium" flex={1}>
  <TitleLarge>T√≠tulo</TitleLarge>
  <BodyStandard>Descri√ß√£o do conte√∫do</BodyStandard>
  <Button>A√ß√£o Principal</Button>
</YStack>
```

**XStack para layouts horizontais:**
```tsx
<XStack space="$small" alignItems="center" justifyContent="space-between">
  <LabelSmall>R√≥tulo</LabelSmall>
  <Button size="small">A√ß√£o</Button>
</XStack>
```

### Responsividade com Breakpoints

Use as props de breakpoint do Tamagui para diferentes tamanhos de tela:

```tsx
<YStack 
  padding="$small" 
  $sm={{ padding: '$medium' }} 
  $md={{ padding: '$large' }}
>
  <XStack 
    flexDirection="column" 
    $sm={{ flexDirection: 'row' }} 
    space="$small"
  >
    <Button flex={1}>Bot√£o 1</Button>
    <Button flex={1}>Bot√£o 2</Button>
  </XStack>
</YStack>
```

### Guia de Uso por Contexto

- **YStack**: Para listas, formul√°rios, conte√∫do sequencial
- **XStack**: Para barras de a√ß√£o, headers, elementos lado a lado
- **flex={1}**: Para componentes que devem ocupar espa√ßo dispon√≠vel
- **space**: Para espa√ßamento consistente entre elementos filhos

### O que Evitar

**‚ùå Utilizando tamanhos fixos:**
```tsx
<View style={{ width: 300, height: 200 }}>
  <Text>Conte√∫do</Text>
</View>
```

> **Exce√ß√£o**: Tamanhos m√≠nimos em controles (como `minHeight` em bot√µes) s√£o permitidos quando necess√°rios para o design.

**Links √∫teis:**
- <a href="https://tamagui.dev/docs/intro/themes#media-queries" target="_blank" rel="noopener noreferrer">Tamagui - Media Queries e Breakpoints</a>
- <a href="https://reactnative.dev/docs/flexbox" target="_blank" rel="noopener noreferrer">React Native - Layout com Flexbox</a>

## 8. Composi√ß√£o de Componentes: Reutiliza√ß√£o Inteligente

**Filosofia**: Prefira compor componentes menores para criar funcionalidades complexas, reutilizando componentes existentes da {LIBRARY_NAME}.

### Exemplo Pr√°tico: Card de Produto

```tsx
import { Card, Button, TitleMedium, BodySmall, LabelSmall, XStack, YStack } from '@superapp-caixa/dsc-library';
import { ShoppingCart, Heart } from 'iconoir-react-native';

export const ProductCard = ({ 
  title, 
  description, 
  price, 
  onAddToCart, 
  onToggleFavorite, 
  isFavorite = false 
}) => {
  return (
    <Card padding="$medium" space="$small">
      <YStack space="$small" flex={1}>
        <TitleMedium numberOfLines={2}>{title}</TitleMedium>
        <BodySmall color="$neutral9" numberOfLines={3}>
          {description}
        </BodySmall>

        <XStack justifyContent="space-between" alignItems="center" marginTop="auto">
          <LabelSmall color="$color9" fontWeight="bold">
            {price}
          </LabelSmall>

          <XStack space="$tiny">
            <Button
              icon={Heart}
              type="chromeless"
              size="small"
              theme={isFavorite ? 'highlight' : 'neutral'}
              onPress={onToggleFavorite}
            />
            <Button icon={ShoppingCart} size="small" onPress={onAddToCart}>
              Adicionar
            </Button>
          </XStack>
        </XStack>
      </YStack>
    </Card>
  );
};
```

### Exemplo: Header de Se√ß√£o

```tsx
import { XStack, YStack, Button, TitleLarge, BodySmall } from '@superapp-caixa/dsc-library';
import { ArrowRight } from 'iconoir-react-native';

export const SectionHeader = ({ title, subtitle, actionLabel, onActionPress }) => {
  return (
    <XStack justifyContent="space-between" alignItems="flex-end" padding="$medium">
      <YStack flex={1} space="$tiny">
        <TitleLarge>{title}</TitleLarge>
        {subtitle && <BodySmall color="$neutral9">{subtitle}</BodySmall>}
      </YStack>

      {actionLabel && (
        <Button 
          type="chromeless" 
          size="small" 
          icon={ArrowRight} 
          iconAfter 
          onPress={onActionPress}
        >
          {actionLabel}
        </Button>
      )}
    </XStack>
  );
};
```

**Links √∫teis:**
- <a href="https://tamagui.dev/docs/guides/how-to-build-a-button" target="_blank" rel="noopener noreferrer">Tamagui - How to Build a Button</a>

## 9. Organiza√ß√£o de Arquivos: Estrutura Padr√£o

Organize cada componente em sua pr√≥pria pasta seguindo esta estrutura padr√£o:

```
components/
  ComponentName/
    index.ts                    # exporta√ß√µes
    ComponentName.tsx           # componente principal
    ComponentName.model.ts      # tipos e interfaces
    ComponentName.stories.tsx   # stories do Storybook
    ComponentName.styles.ts     # styled components (se complexo)
    components/                 # sub-componentes (componentes modulares)
      SubComponent/
        index.ts
        SubComponent.tsx
        SubComponent.model.ts
        SubComponent.styles.ts
    hooks/                      # hooks customizados (se necess√°rio)
      useComponentState.ts
      useComponentInteraction.ts
```

### Padr√µes de Exporta√ß√£o

**Arquivo do componente:**
```tsx
// ComponentName.tsx
export { ComponentName } from './ComponentName';
export type { ComponentNameProps } from './ComponentName.model';
```

**Index principal:**
```tsx
// src/index.ts
export { ComponentName } from './components/ComponentName';
export type { ComponentNameProps } from './components/ComponentName';
```

## 10. Documenta√ß√£o: JSDoc + Storybook

Todo componente deve ter documenta√ß√£o completa em **portugu√™s**.

### JSDoc: Documenta√ß√£o no C√≥digo

Props e componentes devem ser documentados com exemplos de uso:

````tsx
/**
 * Componente DSC ComponentName
 *
 * Descri√ß√£o breve do componente e sua funcionalidade.
 *
 * @example
 * ```tsx
 * <ComponentName 
 *   theme="highlight" 
 *   size="large"
 *   onPress={() => console.log('Pressionado')}
 * >
 *   Conte√∫do
 * </ComponentName>
 * ```
 */
export const ComponentName = ({ theme = 'highlight', ...props }) => {
  // implementa√ß√£o...
};
````

### Storybook: Documenta√ß√£o Visual

**Configura√ß√£o base obrigat√≥ria:**

```tsx
import type { Meta, StoryObj } from '@storybook/react';
import { ComponentName } from './ComponentName';
import type { ComponentNameProps } from './ComponentName.model';

const meta: Meta<ComponentNameProps> = {
  title: 'Componentes/ComponentName',
  component: ComponentName,
  parameters: {
    docs: {
      description: { 
        component: 'Descri√ß√£o detalhada do componente em portugu√™s...' 
      },
      source: {
        transform: (_: string, { args }: any) => {
          const props = [
            args.theme && `theme="${args.theme}"`,
            args.size && `size="${args.size}"`,
            args.icon && `icon={<${args.icon} />}`,
            args.onPress && 'onPress={() => {}}',
          ]
            .filter(Boolean)
            .join(' ');
          return `<ComponentName${props && ` ${props}`}>Conte√∫do</ComponentName>`;
        },
        state: 'open',
      },
    },
  },
  tags: ['autodocs'],
};

export default meta;
type Story = StoryObj<ComponentNameProps>;

// OBRIGAT√ìRIO: Story padr√£o
export const Default: Story = {
  args: {
    theme: 'highlight',
    // outros args padr√£o...
  },
};

// Stories adicionais apenas se necess√°rio
export const ComTema: Story = {
  args: {
    ...Default.args,
    theme: 'danger',
  },
};
```

### Checklist de Documenta√ß√£o

- ‚úÖ **Story Default**: Sempre crie uma story "Default" (obrigat√≥rio)
- ‚úÖ **source.transform**: Configure para exibir c√≥digo JSX correto no "Show code"
- ‚úÖ **Descri√ß√£o em portugu√™s**: Use `docs.description.component`
- ‚úÖ **Stories m√≠nimas**: Crie apenas stories para casos importantes

### Quando Criar Stories Adicionais

Crie stories apenas para:
- **Default**: Estado padr√£o (obrigat√≥rio)
- **Varia√ß√µes importantes**: Diferentes temas, tamanhos, estados
- **Casos especiais**: Funcionalidades espec√≠ficas que precisam ser demonstradas

> ‚ö†Ô∏è **Importante**: Evite criar stories desnecess√°rias. Foque nos casos de uso mais importantes e representativos.


## 11. Performance e Otimiza√ß√µes: Componentes Eficientes

Siga estas pr√°ticas para garantir componentes perform√°ticos.

### styled() vs Estilos Inline

**‚úÖ Prefira styled() para componentes reutiliz√°veis:**

```tsx
// Boa pr√°tica - otimizado
const OptimizedCard = styled(View, {
  name: 'OptimizedCard',
  backgroundColor: '$color1',
  padding: '$medium',
  borderRadius: '$small',
});
```

**‚ùå Evite estilos inline em componentes reutiliz√°veis:**

```tsx
// Evitar - cria novos objetos a cada render
const SlowCard = () => (
  <View
    style={{
      backgroundColor: 'white',
      padding: 16,
      borderRadius: 8,
    }}
  />
);
```

### Preven√ß√£o de Re-renders

**Use React.memo para componentes com props complexas:**

```tsx
import { memo } from 'react';

export const ExpensiveComponent = memo(({ data, onPress }) => {
  return <YStack space="$small">{/* renderiza√ß√£o complexa */}</YStack>;
});
```

**Use useCallback para fun√ß√µes passadas como props:**

```tsx
import { useCallback } from 'react';

export const ParentComponent = () => {
  const handlePress = useCallback((id: string) => {
    // l√≥gica de manipula√ß√£o
  }, []);

  return <OptimizedCard onPress={handlePress} />;
};
```

### Otimiza√ß√µes Espec√≠ficas do Tamagui

**Use a prop `name` no styled() para debugging:**

```tsx
const MyComponent = styled(View, {
  name: 'MyComponent', // facilita debugging e otimiza√ß√µes
  // estilos...
});
```

**Evite c√°lculos pesados em variants:**

```tsx
// ‚úÖ Boa pr√°tica
const variants = {
  size: {
    small: { padding: '$small' },
    large: { padding: '$large' },
  },
} as const;

// ‚ùå Evitar
const variants = {
  size: {
    small: { padding: calculatePadding('small') }, // c√°lculo a cada render
  },
};
```

**Links √∫teis:**
- <a href="https://tamagui.dev/docs/guides/design-systems" target="_blank" rel="noopener noreferrer">Tamagui - Building Design Systems</a>
- <a href="https://react.dev/reference/react/memo" target="_blank" rel="noopener noreferrer">React - memo</a>

---

## Resumo das Conven√ß√µes

Essas conven√ß√µes garantem que a {LIBRARY_NAME} permane√ßa:

- **Consistente**: Uso de tokens, temas e padr√µes visuais
- **Perform√°tica**: Otimiza√ß√µes de renderiza√ß√£o e estilos
- **Acess√≠vel**: Props de acessibilidade e estados interativos
- **Manuten√≠vel**: Estrutura organizada e documenta√ß√£o completa
- **Escal√°vel**: Composi√ß√£o e reutiliza√ß√£o de componentes

> üí° **Lembre-se**: Quando em d√∫vida, consulte os componentes existentes como refer√™ncia e siga essas conven√ß√µes para manter a qualidade da biblioteca.
