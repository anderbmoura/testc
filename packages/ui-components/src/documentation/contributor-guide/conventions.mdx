import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="Guia de Contribuição/Convenções do Projeto" />

# Convenções do Projeto

Descrição das convenções adotadas na DSC Library com o objetivo de garantir consistência, qualidade e facilidade de manutenção dos componentes.

## Design System e Figma

Todos os componentes devem ser desenvolvidos com base nos designs disponíveis na biblioteca do <a href="https://www.figma.com/design/epCGtlKQxedDxQVlK3lNcN/DSC-%7C-React-Native---Tamagui?node-id=1180-3541&p=f&t=sNYfTUNxw7ZfqylZ-0" target="_blank">Figma do projeto</a>. Certifique-se de:

- Consultar o Figma antes de iniciar o desenvolvimento.
- Respeitar as especificações de espaçamento, cores e tipografia.
- Validar o resultado final com o design proposto.

## Tokens e Temas

**Sempre** utilize os tokens e temas definidos na configuração do Tamagui para manter a consistência visual.

**✅ Construindo com tokens:**

```tsx
const MyComponent = styled(View, {
  backgroundColor: '$highlightBg',
  padding: '$small',
  borderRadius: '$nano',
});
```

**❌ Utilizando valores fixos:**

```tsx
const MyComponent = styled(View, {
  backgroundColor: '#FFFFFF',
  padding: 16,
  borderRadius: 8,
});
```

### Exemplos de tokens:

- **[Cores](?path=/docs/design-system-color-palettes--docs)**: `$color1`, `$color9`, `$highlightBg `, etc.
- **Espaçamentos**: `$none`, `$quark`, `$nano`, `$micro`, `$tiny`, `$smaller`, `$small`, `$medium`, `$large`, `$larger`, `$big`, `$bigger`
- **Border Radius**: `$none`, `$quark`, `$nano`, `$small`, `$medium`, `$large`, `$big`, `$pill`
- **Border Width**: `$none`, `$hairline`, `$thin`, `$thick`, `$heavy`
- **Icon Size**: `$tiny`, `$small`, `$medium`, `$large`, `$big`, `$huge`
- **Opacity**: `$4`, `$8`, `$12`, `$16`, `$24`, `$32`, `$40`, `$48`, `$56`, `$64`, `$100`
- **Z-Index**: `$0`, `$100`, `$200`, `$300`, `$400`, `$500`

## Sistema de Tipografia

Use os [componentes de tipografia](?path=/docs/components-typography--docs) específicos da DSC Library para manter consistência visual e semântica.

**Componentes específicos de tipografia:**

```tsx
import {
  DisplayStandard,
  TitleLarge,
  BodyStandard,
  LabelSmall
} from '@superapp-caixa/dsc-library';

<DisplayStandard>Título Principal da Tela</DisplayStandard>
<TitleLarge>Seção Importante</TitleLarge>
<BodyStandard>Texto explicativo do conteúdo</BodyStandard>
<LabelSmall>Rótulo de campo</LabelSmall>
```

**Para valores numéricos, utilize variantes numéricas:**

```tsx
import { DisplayNumericalStandard, TitleNumericalLarge } from '@superapp-caixa/dsc-library';

<DisplayNumericalStandard>R$ 1.234,56</DisplayNumericalStandard>
<TitleNumericalLarge>1.000</TitleNumericalLarge>
```

### Alternativa: Uso direto dos presets

Em casos específicos onde precisar criar componentes customizados, você pode usar os presets de tipografia diretamente:

```tsx
import { styled, Text } from 'tamagui';
import { typography } from '@superapp-caixa/dsc-library';

const CustomTitle = styled(Text, {
  ...typography.titleLarge,
  color: '$color9',
});

const CustomLabel = styled(Text, {
  ...typography.labelSmall,
  textTransform: 'uppercase',
});
```

> ⚠️ **Importante**: Sempre que possível, prefira os [componentes de tipografia](?path=/docs/components-typography--docs). Use os presets diretamente apenas quando os componentes prontos não atendem ao caso de uso específico. Os componentes garantem melhor consistência e manutenibilidade.

## Sistema de Ícones

A DSC Library utiliza a biblioteca <a href="https://iconoir.com/" target="_blank">Iconoir</a> para ícones. Use sempre ícones desta biblioteca para manter consistência visual.

**Utilizando ícones do Iconoir:**

```tsx
import { Home, Settings } from 'iconoir-react-native';
import { Button } from '@superapp-caixa/dsc-library';

<Button icon={Home}>Início</Button>
<Button icon={Settings} size="small">Configurações</Button>
```

**Com tamanho personalizado usando tokens:**

```tsx
import { Home } from 'iconoir-react-native';

<Home width="$iconSize.medium" height="$iconSize.medium" />;
```

## Styled e Variants

Crie componentes usando `styled()` do Tamagui e defina **variants** para diferenças visuais.

**Links úteis:**
- <a href="https://tamagui.dev/docs/core/styled" target="_blank">Tamagui - Styled</a>  
- <a href="https://tamagui.dev/docs/core/variants" target="_blank">Tamagui - Variants</a>

**Exemplo de uso:**

```tsx
import { styled } from 'tamagui';

const DscCard = styled(View, {
  name: 'DscCard',
  borderRadius: '$nano',
  padding: '$large',
  backgroundColor: '$color1',

  variants: {
    tone: {
      neutral: {
        backgroundColor: '$neutral1',
        borderColor: '$neutral4',
      },
      accent: {
        backgroundColor: '$color2',
        borderColor: '$color6',
      },
    },

    size: {
      small: {
        padding: '$small',
      },
      large: {
        padding: '$large',
      },
    },
  } as const,
});
```

## Estados Interativos

Sempre defina estilos para estados de interação quando aplicável.

```tsx
const InteractiveCard = styled(View, {
  // estilos base...

  hoverStyle: {
    backgroundColor: '$color2',
  },

  pressStyle: {
    backgroundColor: '$color3',
  },

  focusStyle: {
    borderColor: '$color9',
    borderWidth: 2,
  },

  disabledStyle: {
    opacity: 0.5,
    backgroundColor: '$neutral3',
  },
});
```

## Modelos de Tipos (.model)

Utilize arquivos `.model.ts` para definir e limitar as possibilidades de customização, especialmente quando baseado em componentes existentes do Tamagui.

```tsx
// Button.model.ts
import { ButtonProps as TamaguiButtonProps } from 'tamagui';

export interface ButtonProps extends Omit<TamaguiButtonProps, 'size' | 'theme'> {
  theme?: 'highlight' | 'neutral' | 'danger';
  size?: 'small' | 'standard' | 'large';
  type?: 'plain' | 'outline' | 'chromeless';
  loading?: boolean;
}
```

## Layout Responsivo

**Utilize flexbox** como principal ferramenta de layout. Evite tamanhos fixos (`width`/`height`) sempre que possível.

### Componentes de Layout

Use `YStack` para layouts verticais e `XStack` para layouts horizontais:

**✅ Layout vertical com YStack:**

```tsx
<YStack space="$medium" padding="$medium" flex={1}>
  <TitleLarge>Título</TitleLarge>
  <BodyStandard>Descrição do conteúdo</BodyStandard>
  <Button>Ação Principal</Button>
</YStack>
```

**✅ Layout horizontal com XStack:**

```tsx
<XStack space="$small" alignItems="center" justifyContent="space-between">
  <LabelSmall>Rótulo</LabelSmall>
  <Button size="small">Ação</Button>
</XStack>
```

**❌ Utilizando tamanhos fixos:**

```tsx
<View style={{ width: 300, height: 200 }}>
  <Text>Conteúdo</Text>
</View>
```

### Breakpoints e Responsividade

Para diferentes tamanhos de tela, use as props de breakpoint do Tamagui:

```tsx
<YStack padding="$small" $sm={{ padding: '$medium' }} $md={{ padding: '$large' }}>
  <XStack flexDirection="column" $sm={{ flexDirection: 'row' }} space="$small">
    <Button flex={1}>Botão 1</Button>
    <Button flex={1}>Botão 2</Button>
  </XStack>
</YStack>
```

### Quando usar cada abordagem

- **YStack**: Para listas, formulários, conteúdo sequencial
- **XStack**: Para barras de ação, headers, elementos lado a lado
- **flex={1}**: Para componentes que devem ocupar espaço disponível
- **space**: Para espaçamento consistente entre elementos filhos

> **Exceção**: Tamanhos mínimos em controles (como `minHeight` em botões) são permitidos quando necessários para o design.

**Links úteis:**
- <a href="https://tamagui.dev/docs/intro/themes#media-queries" target="_blank">Tamagui - Media Queries e Breakpoints</a>
- <a href="https://reactnative.dev/docs/flexbox" target="_blank">React Native - Layout com Flexbox</a>

## Composição de Componentes

Prefira compor componentes menores para criar funcionalidades complexas, reutilizando componentes existentes da DSC Library.

**Exemplo: Criando um Card de Produto compondo o layout com outros componentes:**

```tsx
import { Card, Button, TitleMedium, BodySmall, LabelSmall, XStack, YStack } from '@superapp-caixa/dsc-library';
import { ShoppingCart, Heart } from 'iconoir-react-native';

export const ProductCard = ({ title, description, price, onAddToCart, onToggleFavorite, isFavorite = false }) => {
  return (
    <Card padding="$medium" space="$small">
      <YStack space="$small" flex={1}>
        <TitleMedium numberOfLines={2}>{title}</TitleMedium>
        <BodySmall color="$neutral9" numberOfLines={3}>
          {description}
        </BodySmall>

        <XStack justifyContent="space-between" alignItems="center" marginTop="auto">
          <LabelSmall color="$color9" fontWeight="bold">
            {price}
          </LabelSmall>

          <XStack space="$tiny">
            <Button
              icon={Heart}
              type="chromeless"
              size="small"
              theme={isFavorite ? 'highlight' : 'neutral'}
              onPress={onToggleFavorite}
            />
            <Button icon={ShoppingCart} size="small" onPress={onAddToCart}>
              Adicionar
            </Button>
          </XStack>
        </XStack>
      </YStack>
    </Card>
  );
};
```

**Exemplo: Criando um Header de Seção:**

```tsx
import { XStack, YStack, Button, TitleLarge, BodySmall } from '@superapp-caixa/dsc-library';
import { ArrowRight } from 'iconoir-react-native';

export const SectionHeader = ({ title, subtitle, actionLabel, onActionPress }) => {
  return (
    <XStack justifyContent="space-between" alignItems="flex-end" padding="$medium">
      <YStack flex={1} space="$tiny">
        <TitleLarge>{title}</TitleLarge>
        {subtitle && <BodySmall color="$neutral9">{subtitle}</BodySmall>}
      </YStack>

      {actionLabel && (
        <Button type="chromeless" size="small" icon={ArrowRight} iconAfter onPress={onActionPress}>
          {actionLabel}
        </Button>
      )}
    </XStack>
  );
};
```

**Links úteis:**
- <a href="https://tamagui.dev/docs/guides/how-to-build-a-button" target="_blank">Tamagui - How to Build a Button</a>

## Estrutura de Arquivos

Organize cada componente em sua própria pasta:

```
components/
  MyComponent/
    index.ts          # exportações
    MyComponent.tsx   # componente principal
    MyComponent.model.ts    # tipos e interfaces
    MyComponent.stories.tsx # stories do Storybook
```

## Documentação

Todo componente deve ter:

- **JSDoc**: Props e componentes devem ser documentados, fornecendo exemplos de uso.
- **Storybook**: Documentação mostrando variantes e estados.

````tsx
/**
 * Botão customizado da DSC Library
 *
 * @param theme - Tema visual do botão
 * ```tsx
 * <Button theme="highlight">Botão destaque</Button>
 * ```
 */
export const Button = ({ theme = 'neutral', ...props }) => {
  // implementação...
};
````

## Performance e Otimizações

Siga estas práticas para garantir componentes performáticos:

### Uso de styled() vs Componentes Inline

**✅ Prefira styled() para componentes reutilizáveis:**

```tsx
// Boa prática - otimizado
const OptimizedCard = styled(View, {
  name: 'OptimizedCard',
  backgroundColor: '$color1',
  padding: '$medium',
  borderRadius: '$small',
});
```

**❌ Evite estilos inline em componentes reutilizáveis:**

```tsx
// Evitar - cria novos objetos a cada render
const SlowCard = () => (
  <View
    style={{
      backgroundColor: 'white',
      padding: 16,
      borderRadius: 8,
    }}
  />
);
```

### Prevenção de Re-renders

**Use React.memo para componentes que recebem props complexas:**

```tsx
import { memo } from 'react';

export const ExpensiveComponent = memo(({ data, onPress }) => {
  return <YStack space="$small">{/* renderização complexa */}</YStack>;
});
```

**Use useCallback para funções passadas como props:**

```tsx
import { useCallback } from 'react';

export const ParentComponent = () => {
  const handlePress = useCallback((id: string) => {
    // lógica de manipulação
  }, []);

  return <OptimizedCard onPress={handlePress} />;
};
```

### Otimizações Específicas do Tamagui

**Use a prop `name` no styled() para debugging:**

```tsx
const MyComponent = styled(View, {
  name: 'MyComponent', // facilita debugging e otimizações
  // estilos...
});
```

**Evite cálculos pesados em variants:**

```tsx
// ✅ Boa prática
const variants = {
  size: {
    small: { padding: '$small' },
    large: { padding: '$large' },
  },
} as const;

// ❌ Evitar
const variants = {
  size: {
    small: { padding: calculatePadding('small') }, // cálculo a cada render
  },
};
```

**Links úteis:**

- <a href="https://tamagui.dev/docs/guides/design-systems" target="_blank">Tamagui - Building Design Systems</a>
- <a href="https://react.dev/reference/react/memo" target="_blank">React - memo</a>

> 💡 **Lembre-se**: Essas convenções garantem que a DSC Library permaneça consistente, performática e fácil de manter. Quando em dúvida, consulte os componentes existentes como referência.
