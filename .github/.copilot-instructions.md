# GitHub Copilot Instructions - DSC Library

## Project Overview

DSC Library is a React Native UI component library built with Tamagui, providing a consistent design system for mobile applications. All components follow designs from Figma and implement theme-based styling with responsive layouts.

## Tech Stack

- **Framework**: React Native + Expo
- **Language**: TypeScript
- **UI Framework**: Tamagui (styled components + theming)
- **Icons**: iconoir-react-native + custom SVG icons
- **Documentation**: Storybook
- **Package Manager**: Yarn

## Project Structure

```
packages/ui-components/
  src/
    components/          # UI components
      ComponentName/
        index.ts         # Exports
        ComponentName.tsx           # Main component
        ComponentName.model.ts      # TypeScript interfaces
        ComponentName.stories.tsx   # Storybook stories
        ComponentName.styles.ts     # Styled components (if complex)
        components/      # Sub-components
        hooks/           # Component-specific hooks
    assets/
      icons/            # Custom SVG icons
    utils/              # Shared utilities
    config/             # Tamagui configuration
```

## Design System Foundations

### Figma Reference

**CRITICAL**: All components must be based on [Figma designs](https://www.figma.com/design/epCGtlKQxedDxQVlK3lNcN/DSC-%7C-React-Native---Tamagui). Consult Figma before development to identify tokens, colors, spacing, and typography.

### Theme System & Colors

**Key Question**: "Should the color change with the applied theme?"

**Adaptive Colors** (`$color1` to `$color12`):

- Change automatically based on theme (success, danger, warning, neutral, etc.)
- Use for: Interactive elements, themed icons, contextual UI
- Example: `backgroundColor: '$color8'` → green in success theme, red in danger theme

**Semantic Colors** (`$neutralBg1`, `$successBg`, `$infoBg`, `$dangerBg`):

- Always stay the same regardless of theme
- Use for: Layout backgrounds, fixed brand colors
- Example: `backgroundColor: '$neutralBg1'` → always same neutral gray

**When inspecting Figma**: `color/success/successBg [Color 2]`

- Theme-adaptive → use `$color2`
- Always fixed → use `$successBg`

### Spacing Tokens

Always use spacing tokens: `$nano` (1px), `$quark` (2px), `$tiny` (4px), `$small` (8px), `$medium` (16px), `$large` (24px), `$xl` (32px)

### Typography

**Always prefer typography components**: `<DisplayStandard>`, `<TitleLarge>`, `<BodyStandard>`, `<LabelSmall>`, `<DisplayNumericalStandard>`, `<TitleNumericalLarge>`

**Alternative (rare cases)**: Use presets when components don't fit:

```typescript
import { typography } from '@superapp-caixa/dsc-library';
const CustomText = styled(Text, { ...typography.titleLarge });
```

**Never** use direct Text styling or hardcoded fonts.

### Layout & Responsiveness

**Use flexbox as primary layout tool**. Avoid fixed `width`/`height` unless necessary.

**Layout components**:

- `YStack`: Vertical layouts
- `XStack`: Horizontal layouts
- `flex={1}`: Fill available space
- `space="$medium"`: Consistent child spacing

**Responsive breakpoints**:

```typescript
<YStack padding="$small" $sm={{ padding: '$medium' }} $md={{ padding: '$large' }}>
  <XStack flexDirection="column" $sm={{ flexDirection: 'row' }} space="$small">
    <Button flex={1}>Action</Button>
  </XStack>
</YStack>
```

### Icons

**Use `<Icon>` component** (not useTransformIcon hook):

```typescript
import { Icon } from '@superapp-caixa/dsc-library';
import { Home } from 'iconoir-react-native';

<Icon size="medium" color="$color9"><Home /></Icon>
```

**useTransformIcon hook**: Only for internal library component development.

## Component Development Standards

### Styled Components Pattern

```typescript
const StyledComponent = styled(View, {
  name: 'StyledComponent', // REQUIRED for debugging
  backgroundColor: '$color1',
  padding: '$medium',

  // REQUIRED interaction states
  hoverStyle: { backgroundColor: '$color2' },
  pressStyle: { backgroundColor: '$color3' },
  focusStyle: { borderColor: '$color9', borderWidth: 2, zIndex: 500 },
  disabledStyle: { opacity: 0.5, backgroundColor: '$neutral3' },

  variants: {
    theme: {
      highlight: { borderColor: '$color9' },
      danger: { borderColor: '$red9' },
    },
  } as const,
});
```

### TypeScript Interfaces

**Basic pattern** (`.model.ts` files):

```typescript
import { ViewProps } from 'tamagui';

export interface ComponentProps extends ViewProps {
  theme?: 'highlight' | 'neutral' | 'danger';
  size?: 'small' | 'standard' | 'large';
  title: string;
  onPress?: () => void;
  loading?: boolean;
  disabled?: boolean;
}
```

**Extending Tamagui components**:

```typescript
import { ButtonProps as TamaguiButtonProps } from 'tamagui';

export interface ButtonProps
  extends Omit<TamaguiButtonProps, 'size' | 'theme'> {
  theme?: 'highlight' | 'neutral' | 'danger';
  size?: 'small' | 'standard' | 'large';
  type?: 'plain' | 'outline' | 'chromeless';
}
```

### Component Requirements

- Default theme: `'highlight'`
- All interaction states: hover, press, focus, disabled
- Z-index 500+ for focus borders
- Component `name` prop in styled() for debugging

### Performance Optimization

**Prefer `styled()` over inline styles**:

```typescript
// ✅ Good
const Card = styled(View, { name: 'Card', padding: '$medium' });

// ❌ Avoid
<View style={{ padding: 16 }} />
```

**Prevent re-renders**:

```typescript
import { memo, useCallback } from 'react';

export const Component = memo(({ onPress }) => {
  return <View />;
});

const handlePress = useCallback(() => {}, []);
```

### Component Composition

**Prefer composing small components over creating custom ones**. Reuse existing library components for consistency.

## Documentation Standards

### JSDoc (Portuguese)

````typescript
/**
 * Componente DSC Button
 *
 * Botão interativo com suporte a temas e ícones.
 *
 * @example
 * ```tsx
 * <Button theme="success" icon={Check} onPress={() => {}}>
 *   Confirmar
 * </Button>
 * ```
 */
````

### Storybook Stories

**Minimal required structure**:

```typescript
const meta: Meta<ComponentProps> = {
  title: 'Componentes/ComponentName',
  component: Component,
  parameters: {
    docs: {
      description: { component: 'Descrição em português...' },
      source: {
        transform: (_: string, { args }: any) => {
          // Show proper JSX code
          const props = [
            args.theme && `theme="${args.theme}"`,
            args.icon && `icon={<${args.icon} />}`,
          ]
            .filter(Boolean)
            .join(' ');
          return `<ComponentName${props && ` ${props}`} />`;
        },
        state: 'open',
      },
    },
  },
  tags: ['autodocs'],
};

export const Default: Story = { args: { theme: 'highlight' } };
```

**Required stories**: Default (mandatory) + other stories only if necessary for specific functionality.

### Storybook Reactivity (Icon/Image Mappings)

**Critical for proper controls**:

1. iconMapping must include `None: undefined`
2. argTypes should NOT have `if` conditionals for mapped properties
3. render function must use dynamic key: `<Component key={\`comp-${Date.now()}\`} {...args} />`
4. Don't process args in render - let Storybook handle mappings

## Code Conventions

### Commit Messages

Follow Conventional Commits: `type(scope): description`

**Types**: `feat`, `fix`, `docs`, `refactor`, `perf`, `test`, `style`, `chore`, `build`, `ci`

Examples:

- `feat(button): add loading state`
- `fix(icon): correct color prop type`
- `docs(readme): update installation steps`

### Exports

```typescript
// Component file
export { Component } from './Component';
export type { ComponentProps } from './Component.model';

// Main index.ts
export { Component } from './components/Component';
export type { ComponentProps } from './components/Component';
```

### Magic Numbers vs Tokens

**Prefer tokens** for design system properties: `padding: '$medium'`, `color: '$color9'`

**Direct values acceptable** for component-specific constraints: `minHeight: 44`, `iconSize: 24`

## Key Rules Summary

### ✅ Do

- Base components on Figma designs
- Ask "Should color change with theme?" when choosing colors
- Use design tokens (`$small`, `$color9`)
- Use flexbox layouts, avoid fixed sizes
- Use `<Icon>` component (not useTransformIcon)
- Implement all interaction states (hover, press, focus, disabled)
- Prefer composition over custom components
- Use `styled()` over inline styles
- Use `memo` and `useCallback` for optimization
- Document in Portuguese with JSDoc
- Add `source.transform` in Storybook
- Include `None: undefined` in iconMapping
- Use simple render functions with dynamic keys

### ❌ Don't

- Use hardcoded colors/sizes instead of tokens
- Use inline styles in reusable components
- Use useTransformIcon (use `<Icon>` component)
- Skip disabled state in interactive components
- Use direct Text styling
- Use fixed sizes when flexbox works
- Skip source.transform in stories
- Add `if` conditions to argTypes with mappings
- Process args in render functions
- Forget dynamic keys in render functions

## Common Issues

### Storybook "Show code" doesn't update

1. Add `None: undefined` to mapping
2. Remove `if: { arg: 'prop', eq: 'value' }` from mapped argTypes
3. Use: `render: args => <Component key={\`comp-${Date.now()}\`} {...args} />`
4. Implement getIconName in source.transform

### Storybook controls don't appear

Check if mapping is defined correctly and without conditionals in argTypes.
